<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ¡ãƒ³ãƒãƒ¼ãƒˆã‚¤ãƒ­ãƒ»ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ </title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-database-compat.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@700;900&display=swap');
        body { font-family: 'Zen Maru Gothic', sans-serif; overflow-x: hidden; }
        .card-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .fade-in { animation: fadeIn 0.4s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
    </style>
</head>
<body class="bg-orange-50 min-h-screen p-4 text-slate-800">

    <div id="app" class="max-w-md mx-auto">
        <header class="text-center mb-8 pt-4">
            <h1 class="text-4xl font-black text-orange-600 italic tracking-tighter">ãƒ¡ãƒ³ãƒãƒ¼ãƒˆã‚¤ãƒ­</h1>
            <p id="room-id" class="text-[10px] font-bold text-orange-400">REALTIME SYNC MODE</p>
        </header>
        <div id="game-content"></div>
    </div>

    <script>
        // --- Firebaseè¨­å®š ---
        const firebaseConfig = {
            apiKey: "AIzaSyBmzPmehSaV--mn0Hd0S-fd97nf5RX4Dvg",
            authDomain: "membertoiro.firebaseapp.com",
            databaseURL: "https://membertoiro-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "membertoiro",
            storageBucket: "membertoiro.firebasestorage.app",
            messagingSenderId: "858132874746",
            appId: "1:858132874746:web:9d6e1156a350dd396b9043"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const roomRef = db.ref("rooms/party-room"); // å›ºå®šãƒ«ãƒ¼ãƒ 

        // ãŠé¡Œãƒªã‚¹ãƒˆ (200å€‹)
        const QUESTIONS = [
            {text: "ä¸€ç•ªã€æµ®æ°—ã—ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€é•·ç”Ÿãã—ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€è…¹é»’ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€æ¶™ã‚‚ã‚ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å¯‚ã—ãŒã‚Šå±‹ãªäººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€è² ã‘ãšé…”ã„ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å¤©ç„¶ãƒœã‚±ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€é ‘å›ºãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ãƒ­ãƒãƒ³ãƒã‚¹ãƒˆãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ãƒŠãƒ«ã‚·ã‚¹ãƒˆãªäººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€éš ã—äº‹ãŒä¸‹æ‰‹ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€æ€’ã£ãŸã‚‰æ€–ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€èãä¸Šæ‰‹ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å£ãŒä¸Šæ‰‹ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ãŠäººå¥½ã—ãªäººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€æ¯’èˆŒãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€æ…é‡æ´¾ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€æ¥½è¦³çš„ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ãƒ—ãƒ©ã‚¤ãƒ‰ãŒé«˜ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å¹³å’Œä¸»ç¾©ãªäººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€ã“ã ã‚ã‚ŠãŒå¼·ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ãƒã‚¤ãƒšãƒ¼ã‚¹ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ã‚®ãƒ£ãƒƒãƒ—ãŒæ¿€ã—ã„äººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€æ„›ã•ã‚Œã‚­ãƒ£ãƒ©ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ãƒŸã‚¹ãƒ†ãƒªã‚¢ã‚¹ãªäººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€å˜˜ãŒä¸‹æ‰‹ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å®Ÿã¯ãŠèª¿å­è€…ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€åº¦èƒ¸ãŒã‚ã‚Šãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å®Ÿã¯ãƒŠã‚¤ãƒ¼ãƒ–ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€æ­£ç¾©æ„ŸãŒå¼·ãã†ãªäººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€ãŠå–‹ã‚ŠãŒæ­¢ã¾ã‚‰ãªã„äººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å®Ÿã¯é‡å¿ƒå®¶ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€åŒ…å®¹åŠ›ãŒã‚ã‚Šãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€æ„Ÿå—æ€§ãŒè±Šã‹ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ã‚¹ãƒˆã‚¤ãƒƒã‚¯ãã†ãªäººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€ç”˜ãˆã‚“åŠãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€è‡ªç”±å¥”æ”¾ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å®¢è¦³çš„ãªè¦–ç‚¹ã‚’æŒã¤äººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å®Ÿã¯ç…§ã‚Œå±‹ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€è£è¡¨ãŒãªã•ãã†ãªäººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€å®¶ãŒæ±šãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€è²¯é‡‘ãŒå¤šãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€æ–™ç†ãŒä¸Šæ‰‹ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€æœã«å¼±ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€è¿”ä¿¡ãŒé…ãã†ãªäººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€ãŠé…’ã§å¤±æ•—ã—ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ã‚®ãƒ£ãƒ³ãƒ–ãƒ«ã«ãƒãƒã‚Šãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ç„¡é§„é£ã„ãŒå¤šãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€æ–¹å‘éŸ³ç—´ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å¿˜ã‚Œç‰©ãŒå¤šãã†ãªäººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€SNSã«ä¾å­˜ã—ã¦ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å¯åŠãŒå¤šãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ãƒ€ã‚¤ã‚¨ãƒƒãƒˆãŒç¶šã‹ãªãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€éƒ½ä¼šæš®ã‚‰ã—ãŒä¼¼åˆã†äººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ç”°èˆæš®ã‚‰ã—ãŒä¼¼åˆã†äººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€å¥åº·ã‚ªã‚¿ã‚¯ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å¤šè¶£å‘³ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€æµè¡Œã«æ•æ„Ÿãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å ã„ã«ã¯ã¾ã‚Šãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å­—ãŒç¶ºéº—ãã†ãªäººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€å¤œæ›´ã‹ã—ã—ã¦ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ç¾æ„è­˜ãŒé«˜ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ã‚³ãƒ³ãƒ“ãƒ‹é£¯ãŒå¤šãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€è²·ã„ç‰©ã§è¿·ã„ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€æ•´ç†æ•´é “ãŒè‹¦æ‰‹ãªäººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€å®¶é›»ã«è©³ã—ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ç§æœãŒã‚ªã‚·ãƒ£ãƒ¬ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ä¸€äººã®æ™‚é–“ãŒå¤§äº‹ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ã‚¹ãƒãƒ›ã®ç”»é¢ãŒå‰²ã‚Œã¦ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€è¡å‹•è²·ã„ã‚’ã—ãã†ãªäººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€å¸¸ã«ä½•ã‹ã‚’é£Ÿã¹ã¦ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ç­‹ãƒˆãƒ¬ã‚’å§‹ã‚ã¦ã™ãè¾ã‚ã‚‹äººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å®Ÿã¯ã‚±ãƒãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€é«˜ç´šå“ãŒä¼¼åˆã†äººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€æ—©å¯æ—©èµ·ããã†ãªäººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€é„ã®ä¸­ãŒã‚°ãƒãƒ£ã‚°ãƒãƒ£ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€æ­©ãã®ãŒé€Ÿãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å‚˜ã‚’ã™ãå¤±ãã™äººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ã‚µã‚¦ãƒŠã«ã¯ã¾ã£ã¦ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€è‡ªç‚Šã«å‡ã£ã¦ãã†ãªäººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€å¤§ç‰©ã«ãªã‚Šãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ç„¡äººå³¶ã§ç”Ÿãæ®‹ã‚Šãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ç·ç†å¤§è‡£ã«å‘ã„ã¦ã„ã‚‹äººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ãƒãƒªã‚¦ãƒƒãƒ‰ã«å±…ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€è©æ¬ºå¸«ã«å‹ã¦ãã†ãªäººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€ã‚¾ãƒ³ãƒ“æ˜ ç”»ã§ç”Ÿãæ®‹ã‚‹äººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å®ãã˜ãŒå½“ãŸã‚Šãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€æ¢åµã«å‘ã„ã¦ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€æ‚ªå½¹ãŒä¼¼åˆã„ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å®‡å®™äººã¨å‹é”ã«ãªã‚Œã‚‹äººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€IQãŒé«˜ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å‰ä¸–ãŒç‹æ§˜ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å‰ä¸–ãŒçŒ›ç£ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ãƒ’ãƒ¼ãƒ­ãƒ¼ãŒä¼¼åˆã†äººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€äº¤æ¸‰ãŒä¸Šæ‰‹ãã†ãªäººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€ç¤¾é•·ã«å‘ã„ã¦ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€é‹ã ã‘ã§ç”Ÿãã¦ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€é©å‘½ã‚’èµ·ã“ã—ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å¤©æ‰è‚Œãªæ„Ÿã˜ãŒã™ã‚‹äººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ç›´æ„Ÿã§å‹•ã„ã¦æˆåŠŸã™ã‚‹äººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€ãƒãƒ«ãƒã‚¿ã‚¹ã‚¯ãŒå¾—æ„ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ãƒ—ãƒ¬ã‚¼ãƒ³ãŒä¸Šæ‰‹ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€æš—è¨˜åŠ›ãŒå‡„ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€è·äººé­‚ã‚’æŒã£ã¦ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ã©ã“ã§ã‚‚å¯ã‚‰ã‚Œã‚‹æ‰èƒ½ãŒã‚ã‚‹äººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€äººã®é¡”ã‚’è¦šãˆã‚‹ã®ãŒæ—©ã„äººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€æµè¡Œã‚’ä½œã‚‹å´ã«ãªã‚Šãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å‹è² å¼·ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ãƒ”ãƒ³ãƒã‚’ãƒãƒ£ãƒ³ã‚¹ã«å¤‰ãˆã‚‹äººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ä¸€ç”Ÿç¾å½¹ã§åƒããã†ãªäººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€åˆ¥ã®å›½ã§ã‚‚ç”Ÿãã¦ã„ã‘ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å¤šè¨€èªã‚’æ“ã‚Šãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ç™ºæ˜å®¶ã«å‘ã„ã¦ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ã‚«ãƒªã‚¹ãƒæ€§ãŒã‚ã‚‹äººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€æ­´å²ã«åã‚’æ®‹ã—ãã†ãªäººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€è£æ–¹ã§ä¸–ç•Œã‚’æ“ã£ã¦ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å…ˆç”Ÿã«å‘ã„ã¦ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€èŠ¸è¡“ã‚»ãƒ³ã‚¹ãŒçˆ†ç™ºã—ã¦ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ã‚³ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚¿ãƒ¼ã«å‘ã„ã¦ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ã©ã‚“ãªè·æ¥­ã§ã‚‚å‡ºä¸–ã—ãã†ãªäººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€æ‹äººã«å°½ãã—ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€æ‹äººã®å‰ã§ã‚­ãƒ£ãƒ©ãŒé•ã†äººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å‘Šç™½ã®ã‚»ãƒªãƒ•ãŒã‚¯ã‚µãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ãƒ€ãƒ¡ç”·ãƒ»ãƒ€ãƒ¡å¥³ã«ãƒãƒã‚‹äººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ä¸€ç›®æƒšã‚Œã—ãã†ãªäººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€å«‰å¦¬æ·±ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ãƒ¢ãƒ†æœŸãŒæ°¸é ã«ç¶šãäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å©šæœŸãŒæ—©ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ç•¥å¥ªæ„›ã—ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€éå»ã®æ‹ã‚’å¼•ããšã‚‹äººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€ã‚µãƒ—ãƒ©ã‚¤ã‚ºã«å¤±æ•—ã—ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å­ä¾›ã«å¥½ã‹ã‚Œãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€åˆã‚³ãƒ³ã§ç„¡åŒã—ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ç”˜ãˆä¸Šæ‰‹ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å®Ÿã¯Mãã†ãªäººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€å®Ÿã¯Sãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€åˆå¯¾é¢ã§å¥½å°è±¡ã‚’ä¸ãˆã‚‹äººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€èª°ã¨ã§ã‚‚å‹é”ã«ãªã‚Œã‚‹äººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€èãä¸Šæ‰‹ã§ãƒ¢ãƒ†ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€æŸç¸›ã—ãã†ãªäººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€ãƒ‡ãƒ¼ãƒˆãƒ—ãƒ©ãƒ³ãŒå®Œç’§ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€æ‹ã«ç›²ç›®ã«ãªã‚Šãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å‹æƒ…ã‚’æ‹ã‚ˆã‚Šå„ªå…ˆã™ã‚‹äººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ãƒãƒƒãƒãƒ³ã‚°ã‚¢ãƒ—ãƒªã®é”äººãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å¾©ç¸ã‚’è¿«ã‚‰ã‚Œãã†ãªäººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€çµå©šç›¸æ‰‹ã¨ã—ã¦100ç‚¹ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ç¾©ç†å …ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€è¦ªã«ç´¹ä»‹ã—ã¦å®‰å¿ƒãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€äº­ä¸»é–¢ç™½ãƒ»ã‹ã‹ã‚å¤©ä¸‹ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€åˆ¥ã‚Œã¦ã‚‚å‹é”ã§ã„ã‚‰ã‚Œãã†ãªäººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€å¹´ä¸Šã«å¯æ„›ãŒã‚‰ã‚Œãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å¹´ä¸‹ã«æ…•ã‚ã‚Œãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€æµ®æ°—ãŒã™ããƒãƒ¬ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€æ„›å¦»å®¶ãƒ»æ„›å¤«å®¶ã«ãªã‚Šãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€è¨˜å¿µæ—¥ã‚’çµ¶å¯¾å¿˜ã‚Œãªã„äººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€é§†ã‘å¼•ããŒä¸Šæ‰‹ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€è‡ªåˆ†ã‹ã‚‰å‘Šç™½ã§ããªã„äººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å¤±æ‹ã—ã¦ã‚‚ç«‹ã¡ç›´ã‚ŠãŒæ—©ã„äººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€é‹å‘½ã‚’ä¿¡ã˜ã¦ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€æ‹ã®æ‚©ã¿ç›¸è«‡ã‚’å—ã‘ã¾ãã‚‹äººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€é…”ã†ã¨èªã‚Šãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€é…”ã†ã¨æ³£ããã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€é…”ã†ã¨å¯ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€é…”ã†ã¨è„±ããã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ãƒã‚¤ã‚¯ã‚’é›¢ã•ãªãã†ãªäººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€å¥¢ã£ã¦ãã‚Œãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å¹¹äº‹ãŒä¸Šæ‰‹ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€æ˜æ—¥ä»•äº‹ãªã®ã«é£²ã‚€äººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€é£²ã¿ä¼šã«çµ¶å¯¾å±…ã¦ã»ã—ã„äººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€é…”ã£ã¦ã‚‚é¡”ã«å‡ºãªã„äººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€ã‚«ãƒ©ã‚ªã‚±ã®é¸æ›²ãŒæ¸‹ã„äººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€æ‰‹å“ãŒã§ããã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒä¸€ç•ªå¤§ãã„äººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€äºŒæ¬¡ä¼šã«çµ¶å¯¾æ¥ã‚‹äººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€æœ€å¾Œã¾ã§æ­£æ°—ãªäººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€ãŠã¤ã¾ã¿ã®ãƒãƒ§ã‚¤ã‚¹ãŒè‰¯ã„äººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ç››ã‚Šä¸Šã’éšŠé•·ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ãƒ€ãƒ³ã‚¹ãŒã‚­ãƒ¬ã‚­ãƒ¬ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å®Ÿã¯ä¸‹ãƒã‚¿ã«å¼·ã„äººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ã“ã®ä¸­ã§ä¸€ç•ªã®å¼·é‹ã®æŒã¡ä¸»ã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€éƒ½å¸‚ä¼èª¬ã‚’ä¿¡ã˜ã¦ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å®å³¶ã‚’è¦‹ã¤ã‘ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€çŒ«ã¨ä¼šè©±ã—ã¦ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å®Ÿã¯éœŠæ„ŸãŒã‚ã‚Šãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å®‡å®™ã‹ã‚‰æ¥ãŸã¨è¨€ã‚ã‚Œã¦ã‚‚ç´å¾—ã™ã‚‹äººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€ç„¡äººå³¶ã§ã‚‚Wi-Fiã‚’æ¢ã—ã¦ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ã‚¿ã‚¤ãƒ ã‚¹ãƒªãƒƒãƒ—ã—ã¦ã‚‚é¦´æŸ“ã¿ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å®Ÿã¯ä¸€ç•ªè…•ã£ç¯€ãŒå¼·ãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€é­”æ³•å°‘å¥³ãƒ»å°‘å¹´ã«ãªã‚Œãã†ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ã©ã‚“ãªæœã§ã‚‚ç€ã“ãªã—ãã†ãªäººã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€ã“ã®ä¸­ã§è¬ãŒå¤šã„äººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å®Ÿã¯ä¸€ç•ªã®ã—ã£ã‹ã‚Šè€…ã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€å®Ÿã¯ãŠç¥­ã‚Šç”·ãƒ»ãŠç¥­ã‚Šå¥³ãªã®ã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€1äººã‚­ãƒ£ãƒ³ãƒ—ã‚’æ¥½ã—ã‚“ã§ãã†ãªã®ã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ã©ã‚“ãªå‹•ç‰©ã¨ã‚‚ä»²è‰¯ããªã‚Œãã†ãªã®ã¯ï¼Ÿ"},
            {text: "ä¸€ç•ªã€å®Ÿã¯ç­‹è‚‰ãŒã‚ã‚Šãã†ãªã®ã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ç”Ÿæ¶¯å¹¸ã›ã«ãªã‚Šãã†ãªã®ã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ã“ã®ã‚²ãƒ¼ãƒ ã‚’ä¸€ç•ªæ¥½ã—ã‚“ã§ã„ã‚‹äººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€ã“ã®ä¸­ã§æœ€ã‚‚ã€Œãƒˆã‚¤ãƒ­ã€ãªäººã¯ï¼Ÿ"}, {text: "ä¸€ç•ªã€æœ€å¾Œã¾ã§ã¿ã‚“ãªã‚’ç¬‘ã‚ã›ã‚‹äººã¯ï¼Ÿ"}
        ];

        let myName = localStorage.getItem("toiro-name") || "";
        let gameState = { phase: 'setup', members: [], host: "", questions: [], currentQIdx: 0, answers: {}, revealQIdx: 0 };

        // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç›£è¦–
        roomRef.on("value", (snapshot) => {
            const data = snapshot.val();
            if (data) {
                gameState = data;
                render();
            }
        });

        function render() {
            const container = document.getElementById('game-content');
            
            // å‚åŠ ç™»éŒ²ç”»é¢
            if (!myName) {
                container.innerHTML = `
                    <div class="bg-white p-6 rounded-3xl shadow-xl border-2 border-orange-100">
                        <p class="text-sm font-bold text-orange-400 mb-2">WELCOME</p>
                        <input id="name-input" type="text" placeholder="ã‚ãªãŸã®åå‰" class="w-full mb-4 border-2 border-orange-100 rounded-xl px-4 py-2 outline-none focus:border-orange-400 font-bold">
                        <button onclick="joinGame()" class="w-full bg-orange-500 text-white h-12 rounded-xl font-bold shadow-lg">å‚åŠ ã™ã‚‹</button>
                    </div>`;
                return;
            }

            if (gameState.phase === 'setup') {
                container.innerHTML = `
                    <div class="bg-white p-6 rounded-3xl shadow-xl mb-6">
                        <p class="text-center font-bold text-orange-600 mb-4 animate-pulse">ãƒ¡ãƒ³ãƒãƒ¼å¾…æ©Ÿä¸­...</p>
                        <div class="card-grid">
                            ${(gameState.members || []).map(m => `<div class="bg-orange-50 p-2 rounded-lg text-center font-bold text-sm text-orange-700">ğŸ‘¤ ${m} ${m === myName ? '(è‡ªåˆ†)' : ''}</div>`).join('')}
                        </div>
                    </div>
                    ${gameState.host === myName ? `<button onclick="startGame()" class="w-full bg-orange-600 text-white h-16 rounded-2xl text-xl font-bold shadow-lg">å…¨å“¡æƒã£ãŸï¼é–‹å§‹</button>` : `<p class="text-center text-sm text-slate-400 italic">ãƒ›ã‚¹ãƒˆ(${gameState.host})ã®é–‹å§‹ã‚’å¾…ã£ã¦ã„ã¾ã™...</p>`}
                    <button onclick="localStorage.clear(); location.reload();" class="w-full mt-8 text-[10px] text-slate-300">åå‰ã‚’ã‚„ã‚Šç›´ã™</button>
                `;
            } 
            
            else if (gameState.phase === 'playing') {
                const q = gameState.questions[gameState.currentQIdx];
                const myAns = (gameState.answers[gameState.currentQIdx] || {})[myName];
                const answeredCount = Object.keys(gameState.answers[gameState.currentQIdx] || {}).length;

                container.innerHTML = `
                    <div class="text-center mb-6 px-4">
                        <span class="bg-orange-200 text-orange-700 px-3 py-1 rounded-full text-[10px] font-bold">Q ${gameState.currentQIdx + 1} / ${gameState.questions.length}</span>
                        <h2 class="text-3xl font-black mt-4 mb-2 leading-tight text-slate-800">${q.text}</h2>
                    </div>
                    ${myAns ? `
                        <div class="bg-white p-8 rounded-3xl text-center shadow-inner border border-orange-100">
                            <p class="text-orange-500 font-bold mb-2">å›ç­”å®Œäº†ï¼</p>
                            <p class="text-slate-400 text-sm">ä»–ã®äººã‚’å¾…ã£ã¦ã„ã¾ã™ (${answeredCount}/${gameState.members.length})</p>
                        </div>` : `
                        <div class="card-grid px-4">
                            ${gameState.members.map(m => `<button onclick="submitAnswer('${m}')" class="h-16 rounded-2xl font-bold text-lg bg-white border-b-4 border-orange-200 text-orange-600 active:border-b-0 active:translate-y-1 transition-all">${m}</button>`).join('')}
                        </div>`}
                `;
                if (gameState.host === myName && answeredCount === gameState.members.length) {
                    setTimeout(() => roomRef.update({ phase: 'revealing', revealQIdx: gameState.currentQIdx }), 1000);
                }
            }

            else if (gameState.phase === 'revealing') {
                const h = { question: gameState.questions[gameState.revealQIdx].text, answers: gameState.answers[gameState.revealQIdx] };
                const counts = {};
                gameState.members.forEach(m => counts[m] = 0);
                Object.values(h.answers).forEach(val => counts[val]++);
                const maxVotes = Math.max(...Object.values(counts));
                const winners = Object.keys(counts).filter(m => counts[m] === maxVotes);

                container.innerHTML = `
                    <div class="fade-in text-center px-4">
                        <p class="text-orange-500 font-bold mb-2 uppercase text-[10px]">Result ${gameState.revealQIdx + 1}</p>
                        <h2 class="text-2xl font-black text-slate-700 mb-6">${h.question}</h2>
                        <div class="bg-white p-8 rounded-[3rem] shadow-2xl border-4 border-orange-500 mb-8">
                            <p class="text-xs font-bold text-slate-400 mb-3">Top Vote</p>
                            <div class="flex flex-wrap justify-center items-end gap-2">
                                ${winners.map(w => `<span class="text-4xl font-black text-orange-600">${w}<small class="text-lg ml-1 font-bold text-orange-400">ã•ã‚“</small></span>`).join('<span class="text-xl text-orange-200">&</span>')}
                            </div>
                        </div>
                        ${gameState.host === myName ? `<button onclick="nextStep()" class="w-full bg-orange-600 text-white h-16 rounded-2xl text-xl font-bold shadow-lg">${gameState.revealQIdx < gameState.questions.length - 1 ? 'æ¬¡ã®å•é¡Œã¸' : 'æœ€çµ‚çµæœã¸'}</button>` : `<p class="text-slate-400 italic text-sm">ãƒ›ã‚¹ãƒˆãŒç”»é¢ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ã®ã‚’å¾…ã£ã¦ã„ã¾ã™...</p>`}
                    </div>`;
            }

            else if (gameState.phase === 'result') {
                showFinalSummary(container);
            }
        }

        function joinGame() {
            const input = document.getElementById('name-input');
            const name = input.value.trim();
            if (!name) return;
            myName = name;
            localStorage.setItem("toiro-name", name);
            roomRef.transaction(current => {
                if (!current) current = { phase: 'setup', members: [], host: name };
                if (!current.members) current.members = [];
                if (!current.members.includes(name)) current.members.push(name);
                if (!current.host) current.host = name;
                return current;
            });
        }

        function startGame() {
            const selectedQs = QUESTIONS.sort(() => 0.5 - Math.random()).slice(0, gameState.members.length);
            roomRef.update({ phase: 'playing', questions: selectedQs, currentQIdx: 0, answers: {} });
        }

        function submitAnswer(selection) {
            roomRef.child(`answers/${gameState.currentQIdx}/${myName}`).set(selection);
        }

        function nextStep() {
            if (gameState.revealQIdx < gameState.questions.length - 1) {
                roomRef.update({ phase: 'playing', currentQIdx: gameState.revealQIdx + 1 });
            } else {
                roomRef.update({ phase: 'result' });
            }
        }

        function showFinalSummary(container) {
            const pairScores = {};
            const numMembers = gameState.members.length;
            const numQuestions = gameState.questions.length;
            let totalPairMatches = 0;
            const possiblePairs = (numMembers * (numMembers - 1)) / 2;

            for(let i=0; i<numMembers; i++) {
                for(let j=i+1; j<numMembers; j++) {
                    pairScores[`${gameState.members[i]},${gameState.members[j]}`] = 0;
                }
            }

            gameState.questions.forEach((_, qIdx) => {
                const ans = gameState.answers[qIdx] || {};
                Object.keys(pairScores).forEach(pair => {
                    const [p1, p2] = pair.split(',');
                    if (ans[p1] === ans[p2]) { pairScores[pair]++; totalPairMatches++; }
                });
            });

            const syncRate = Math.round((totalPairMatches / (possiblePairs * numQuestions)) * 100);
            const maxScore = Math.max(...Object.values(pairScores));
            const bestPairs = Object.entries(pairScores).filter(([_, s]) => s === maxScore).map(([p]) => p.replace(',', ' & '));

            const getRank = (r) => {
                if (r === 100) return { t: "å¥‡è·¡ã®ãƒˆã‚¤ãƒ­", d: "100%ä¸€è‡´ï¼ã‚‚ã¯ã‚„ä¸€ã¤ã®ç”Ÿå‘½ä½“ã€‚ä¼èª¬ç´šã®ç›¸æ€§ã§ã™ï¼" };
                if (r >= 90) return { t: "é‹å‘½å…±åŒä½“", d: "ã»ã¼å®Œç’§ã€‚ä»¥å¿ƒä¼å¿ƒã©ã“ã‚ã‹è„³ãŒã¤ãªãŒã£ã¦ã„ã¾ã™ã€‚" };
                if (r >= 80) return { t: "é­‚ã®åŒå­", d: "é©šç•°ã®ä¸€è‡´ç‡ã€‚è¨€ã‚ãªãã¦ã‚‚åˆ†ã‹ã‚Šåˆãˆã‚‹ä»²ã§ã™ã­ã€‚" };
                if (r >= 70) return { t: "é˜¿å½ã®å‘¼å¸", d: "æŠœç¾¤ã®å®‰å®šæ„Ÿã€‚éš£ã«ã„ã‚‹ã®ãŒå½“ãŸã‚Šå‰ãªãƒ¬ãƒ™ãƒ«ã€‚" };
                if (r >= 60) return { t: "ä»¥å¿ƒä¼å¿ƒ", d: "ã‚·ãƒ³ã‚¯ãƒ­ã—ã¦ã¾ã™ï¼ã‹ãªã‚Šã®ä»²è‰¯ã—ã‚°ãƒ«ãƒ¼ãƒ—ã€‚" };
                if (r >= 50) return { t: "å…±é³´ã™ã‚‹ä»²é–“", d: "åŠåˆ†ä»¥ä¸Šé€šã˜åˆã£ã¦ã„ã‚‹ã€æ¯ã®åˆã£ãŸé–¢ä¿‚ã§ã™ã€‚" };
                if (r >= 40) return { t: "è‰¯ãç†è§£è€…", d: "äº’ã„ã®å€‹æ€§ã‚’èªã‚ã¤ã¤ã€å¤§äº‹ãªã¨ã“ã‚ã¯ä¸€è‡´ã—ã¾ã™ã€‚" };
                if (r >= 30) return { t: "æ„æ°—æŠ•åˆ", d: "ã“ã‚Œã‹ã‚‰ã‚‚ã£ã¨ã‚·ãƒ³ã‚¯ãƒ­ç‡ã‚’ä¸Šã’ã¦ã„ã‘ã‚‹å¯èƒ½æ€§å¤§ï¼" };
                if (r >= 15) return { t: "ä¼¸ã³ä»£ãŸã£ã·ã‚Š", d: "ãƒãƒ©ãƒãƒ©ã ã‹ã‚‰ã“ãé¢ç™½ã„ã€‚æ–°ã—ã„ç™ºè¦‹ãŒã‚ã‚‹é–¢ä¿‚ã€‚" };
                return { t: "å­¤é«˜ã®é›†å›£", d: "å…¨å“¡ãŒãƒ¦ãƒ‹ãƒ¼ã‚¯ã™ãã‚‹ï¼é€†ã«å¥‡è·¡çš„ãªãƒãƒ©ãƒãƒ©å…·åˆã€‚" };
            };
            const rank = getRank(syncRate);

            container.innerHTML = `
                <div class="text-center fade-in px-4">
                    <p class="text-[10px] font-bold text-orange-400 mb-1 tracking-widest">Total Sync Rate</p>
                    <h2 class="text-8xl font-black text-orange-600 italic mb-4">${syncRate}<small class="text-4xl">%</small></h2>
                    <div class="mb-8 bg-white p-4 rounded-3xl shadow-sm border border-orange-100">
                        <div class="inline-block bg-orange-600 text-white px-6 py-1 rounded-full font-black text-lg shadow-md mb-2">${rank.t}</div>
                        <p class="text-xs text-slate-500 italic leading-relaxed">${rank.d}</p>
                    </div>
                    <div class="bg-gradient-to-br from-orange-500 to-orange-600 p-6 rounded-[2.5rem] shadow-xl text-white mb-8">
                        <p class="text-[10px] font-bold mb-3 uppercase tracking-widest opacity-90 border-b border-orange-300 inline-block pb-1">Best Match Pair</p>
                        <h3 class="text-2xl font-black mb-1 leading-tight">${bestPairs.join('<br>')}</h3>
                        <p class="text-orange-100 text-[10px] font-bold">ä¸€è‡´æ•°: ${maxScore}å›</p>
                    </div>
                    ${gameState.host === myName ? `<button onclick="roomRef.set(null); location.reload();" class="w-full bg-white text-orange-600 border-2 border-orange-200 h-14 rounded-2xl font-bold shadow-sm mb-10">éƒ¨å±‹ã‚’è§£æ•£ã—ã¦çµ‚äº†</button>` : `<p class="text-slate-400 text-xs">ãƒ›ã‚¹ãƒˆãŒéƒ¨å±‹ã‚’è§£æ•£ã™ã‚‹ã®ã‚’å¾…ã£ã¦ã„ã¾ã™</p>`}
                </div>`;
        }
        render();
    </script>
</body>
</html>