<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no" />
    <title>„Ç¶„Çß„Éº„Éñ„É¨„É≥„Ç∞„Çπ ÂÆåÂÖ®Áâà</title>
    <style>
        :root{
            --zone-4-color:#03A9F4;
            --zone-3-color:#FF9800;
            --zone-2-color:#FFC107;
            --needle-color:#F44336;
            --text-color:#333;
            --dial-frame-color:#3D4A5E;
            --red-team-color:#FF5252;
            --blue-team-color:#2196F3;
            --red-team-bg:#FFEBEE;
            --blue-team-bg:#E3F2FD;
        }
        *{box-sizing:border-box;margin:0;padding:0}
        body{
            font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial;
            min-height:100vh;
            display:flex;
            align-items:center;
            justify-content:center;
            padding:16px;
            color:var(--text-color);
            transition: background-color 0.5s ease;
        }
        
        .red-team-turn { background-color: var(--red-team-bg); }
        .blue-team-turn { background-color: var(--blue-team-bg); }
        .neutral-bg { background-color: #F0F2F5; }

        .game-container{
            width:100%;
            max-width:520px;
            background:#fff;
            border-radius:16px;
            padding:20px;
            box-shadow:0 10px 30px rgba(0,0,0,0.08);
        }
        
        .header{text-align:center;margin-bottom:14px;border-bottom:1px solid #eee;padding-bottom:12px;}
        .title{font-size:1.6rem;color:var(--dial-frame-color)}
        
        .scoreboard{
            display:flex;
            justify-content:space-between;
            margin-bottom:16px;
            padding:12px;
            background:#f8f9fa;
            border-radius:10px;
        }
        
        .team-score{
            text-align:center;
            padding:8px 16px;
            border-radius:8px;
            font-weight:700;
            font-size:1.1rem;
            flex: 1;
            margin: 0 5px;
        }
        
        .red-team-score{ background:var(--red-team-bg); color:var(--red-team-color); border:2px solid var(--red-team-color); }
        .blue-team-score{ background:var(--blue-team-bg); color:var(--blue-team-color); border:2px solid var(--blue-team-color); }
        .current-team{ box-shadow:0 4px 12px rgba(0,0,0,0.15); transform:scale(1.05); }

        .topic-display{background:#3D4A5E; color: white; border-radius:10px; padding:15px; margin-bottom:16px}
        .topic-text{display:flex; justify-content:space-between; align-items:center; font-weight:700; font-size:1.2rem}
        .phase-content{text-align:center}
        
        .team-indicator{
            font-size:1.3rem;
            font-weight:800;
            margin-bottom:12px;
            padding:8px 16px;
            border-radius:8px;
            display:inline-block;
        }
        
        .red-team-indicator{ background:var(--red-team-color); color:white; }
        .blue-team-indicator{ background:var(--blue-team-color); color:white; }

        .btn{width:100%;padding:12px;border:none;border-radius:40px;background:linear-gradient(45deg,#2196F3,#03A9F4);color:white;font-weight:700;cursor:pointer;margin:8px 0; font-size: 1rem;}
        .btn-secondary{background:linear-gradient(45deg,#673AB7,#9C27B0)}
        .btn-change{background:linear-gradient(45deg,#757575,#9E9E9E); margin-top: 15px;}
        
        .vote-buttons{ display:flex; gap:12px; margin:16px 0; }
        .vote-btn{ flex:1; padding:16px; border:none; border-radius:12px; font-weight:700; font-size:1.1rem; cursor:pointer; }
        .vote-left{ background:linear-gradient(45deg,#9C27B0,#E91E63); color:white; }
        .vote-right{ background:linear-gradient(45deg,#2196F3,#00BCD4); color:white; }
        
        .hidden{display:none}

        .wavelength-dial{
            position:relative; width:320px; max-width:100%; height:160px; margin:20px auto;
            border-top-left-radius:160px; border-top-right-radius:160px;
            background:#E0E5EC; 
            overflow:visible;
        }
        .wavelength-dial svg{ position:absolute; left:0; top:0; width:100%; height:100%; overflow:visible; }

        .needle{
            position:absolute; left:50%; bottom:0; width:4px; height:140px;
            background:var(--needle-color); transform-origin:50% 100%;
            transform:translateX(-50%) rotate(0deg); z-index:6; border-radius:2px;
        }

        .knob{
            position:absolute; width:32px; height:32px; border-radius:50%;
            background:var(--needle-color); border:4px solid #fff;
            box-shadow:0 6px 14px rgba(0,0,0,0.15); transform:translate(-50%,-50%);
            z-index:7; touch-action:none; cursor:grab;
        }
        
        .gauge-value{ font-weight:700; margin:10px 0; font-size:1.2rem; color:var(--dial-frame-color); }
        .result-summary{ background:#f8f9fa; padding:16px; border-radius:10px; margin:16px 0; }
    </style>
</head>
<body class="neutral-bg">
    <div class="game-container">
        <div class="header"><div class="title">„Ç¶„Çß„Éº„Éñ„É¨„É≥„Ç∞„Çπ</div></div>

        <div class="scoreboard" id="scoreboard">
            <div class="team-score red-team-score" id="redTeamScore">Ëµ§: 0</div>
            <div class="team-score blue-team-score" id="blueTeamScore">Èùí: 0</div>
        </div>

        <div class="topic-display">
            <div class="topic-text" id="topicText"><span>Â∑¶</span><span>‚áî</span><span>Âè≥</span></div>
        </div>

        <div class="game-phase" id="phase-start">
            <div class="phase-content">
                <p>11ÁÇπÂÖàÂèñ„ÅßÂãùÂà©ÔºÅ</p>
                <button class="btn" onclick="startNewGame()">„Ç≤„Éº„É†ÈñãÂßã</button>
            </div>
        </div>

        <div class="game-phase hidden" id="phase-round-start">
            <div class="phase-content">
                <div class="team-indicator" id="currentTeamIndicator">Ëµ§„ÉÅ„Éº„É†</div>
                <p>„ÅÆÁï™„Åß„Åô</p>
                <button class="btn" onclick="startRound()">„ÅäÈ°å„ÇíÂºï„Åè</button>
            </div>
        </div>

        <div class="game-phase hidden" id="phase-psychic">
            <div class="phase-content">
                <div class="team-indicator" id="psychicTeamIndicator">Ëµ§„ÉÅ„Éº„É†</div>
                <h3 style="color:red">„Éí„É≥„ÉàÂΩπ‰ª•Â§ñ„ÅØË¶ã„Å™„ÅÑ„ÅßÔºÅ</h3>
                <div class="wavelength-dial">
                    <svg id="psychic-svg" viewBox="0 0 320 160"></svg>
                </div>
                <button class="btn" onclick="goToVotePhase()">„Éí„É≥„Éà„ÇíÂá∫„Åó„Åü</button>
                <button class="btn btn-change" id="changeTopicBtn" onclick="changeTopic()">„ÅäÈ°å„ÇíÂ§âÊõ¥ (0/3)</button>
            </div>
        </div>

        <div class="game-phase hidden" id="phase-vote">
            <div class="phase-content">
                <div class="team-indicator" id="voteTeamIndicator">Èùí„ÉÅ„Éº„É†</div>
                <h3>„Å©„Å°„ÇâÂØÑ„ÇäÔºü</h3>
                <div class="vote-buttons">
                    <button class="vote-btn vote-left" onclick="submitVote('left')"><div id="leftLabel">Â∑¶ÂØÑ„Çä</div></button>
                    <button class="vote-btn vote-right" onclick="submitVote('right')"><div id="rightLabel">Âè≥ÂØÑ„Çä</div></button>
                </div>
            </div>
        </div>

        <div class="game-phase hidden" id="phase-guess">
            <div class="phase-content">
                <div class="team-indicator" id="guessTeamIndicator">Ëµ§„ÉÅ„Éº„É†</div>
                <h3>Ê≠£Á¢∫„Å™‰ΩçÁΩÆ„ÇíÁãô„ÅàÔºÅ</h3>
                <div class="wavelength-dial" id="guess-dial">
                    <svg id="guess-svg" viewBox="0 0 320 160"></svg>
                    <div class="needle" id="needle"></div>
                    <div class="knob" id="knob"></div>
                </div>
                <div class="gauge-value">‰ΩçÁΩÆ: <span id="gaugeValue">50</span></div>
                <button class="btn" onclick="submitGuess()">Ê±∫ÂÆöÔºÅ</button>
            </div>
        </div>

        <div class="game-phase hidden" id="phase-result">
            <div class="phase-content">
                <h3>ÁµêÊûúÁô∫Ë°®</h3>
                <div class="wavelength-dial">
                    <svg id="result-svg" viewBox="0 0 320 160"></svg>
                    <div class="needle" id="result-needle"></div>
                </div>
                <div class="result-summary" id="resultSummary"></div>
                <button class="btn btn-secondary" id="nextRoundBtn" onclick="nextRound()">Ê¨°„Å∏</button>
            </div>
        </div>

        <div class="game-phase hidden" id="phase-game-over">
            <div class="phase-content">
                <div id="winnerAnnouncement" style="font-size:2rem; font-weight:800; margin:20px 0;"></div>
                <button class="btn" onclick="startNewGame()">ÊúÄÂàù„Åã„ÇâÈÅä„Å∂</button>
            </div>
        </div>
    </div>

    <script>
    // --- „Ç∏„É£„É≥„É´Âà•„ÅäÈ°å„É™„Çπ„Éà (ÂêàË®à200ÂÄã) ---
    const topicStore = {
        standard: [
            {left:"ÊÇ™„ÅÑ", right:"ËâØ„ÅÑ"}, {left:"ÊôÆÈÄö", right:"Â•áÂ¶ô"}, {left:"ÂÆâ‰æ°", right:"È´ò‰æ°"}, {left:"ÁÑ°Âêç", right:"ÊúâÂêç"}, {left:"Ê±ö„ÅÑ", right:"„Åç„Çå„ÅÑ"}, {left:"‰Ωø„ÅÑ„Å´„Åè„ÅÑ", right:"‰Ωø„ÅÑ„ÇÑ„Åô„ÅÑ"}, {left:"ÂΩπ„Å´Á´ã„Åü„Å™„ÅÑ", right:"ÂΩπ„Å´Á´ã„Å§"}, {left:"Á∞°Âçò", right:"Èõ£„Åó„ÅÑ"}, {left:"‰ΩéÂìÅË≥™", right:"È´òÂìÅË≥™"}, {left:"‰∏ÄÊôÇÁöÑ", right:"Ê∞∏Á∂öÁöÑ"}, {left:"ÁèæÂÆü", right:"Á©∫ÊÉ≥"}, {left:"ÈÅéÂéª", right:"Êú™Êù•"}, {left:"Âú∞Âë≥", right:"Ê¥æÊâã"}, {left:"Áã≠„ÅÑ", right:"Â∫É„ÅÑ"}, {left:"Êöó„ÅÑ", right:"Êòé„Çã„ÅÑ"}, {left:"ËªΩ„ÅÑ", right:"Èáç„ÅÑ"}, {left:"Èùô„Åã", right:"„ÅÜ„Çã„Åï„ÅÑ"}, {left:"Âº±„ÅÑ", right:"Âº∑„ÅÑ"}, {left:"Â´å„ÅÑ", right:"Â•Ω„Åç"}, {left:"ÂÅΩÁâ©", right:"Êú¨Áâ©"}, {left:"ÈÅéÂ∞èË©ï‰æ°„Å™„Ç¢„É´„Éï„Ç°„Éô„ÉÉ„Éà", right:"ÈÅéÂ§ßË©ï‰æ°„Å™„Ç¢„É´„Éï„Ç°„Éô„ÉÉ„Éà"}
        ],
        food: [
            {left:"„Åä„ÇÑ„Å§", right:"È£ü‰∫ã"}, {left:"Â≠ê‰æõ„ÅÆÂë≥", right:"Â§ß‰∫∫„ÅÆÂë≥"}, {left:"ÂíåÈ£ü", right:"Ê¥ãÈ£ü"}, {left:"„Éû„É®„Éç„Éº„Ç∫„Å´Âêà„ÅÜ", right:"„Ç±„ÉÅ„É£„ÉÉ„Éó„Å´Âêà„ÅÜ"}, {left:"ÊØéÊó•È£ü„Åπ„Çâ„Çå„Çã", right:"„Åü„Åæ„Å´„Åß„ÅÑ„ÅÑ"}, {left:"„ÅîË§íÁæé", right:"Êó•Â∏∏È£ü"}, {left:"„Çπ„Éë„Ç§„Ç∑„Éº", right:"„Éû„Ç§„É´„Éâ"}, {left:"‰Ωé„Ç´„É≠„É™„Éº", right:"È´ò„Ç´„É≠„É™„Éº"}, {left:"ÂÅ•Â∫∑ÁöÑ", right:"‰∏çÂÅ•Â∫∑Ôºà„Å†„ÅåÁæéÂë≥„ÅÑÔºâ"}, {left:"ÂÆ∂„ÅßÈ£ü„Åπ„Çã", right:"Â§ñ„ÅßÈ£ü„Åπ„Çã"}, {left:"Êúù„Åî„ÅØ„Çì", right:"Êô©„Åî„ÅØ„Çì"}, {left:"ÂÜ∑„Åü„ÅÑ„Åª„ÅÜ„Åå„ÅÑ„ÅÑ", right:"Ê∏©„Åã„ÅÑ„Åª„ÅÜ„Åå„ÅÑ„ÅÑ"}, {left:"„Å§„Åæ„Åø", right:"„Åä„Åã„Åö"}, {left:"Áîò„ÅÑ", right:"„Åó„Çá„Å£„Å±„ÅÑ"}, {left:"Êâã‰Ωú„Çä", right:"Êó¢Ë£ΩÂìÅ"}, {left:"Êüî„Çâ„Åã„ÅÑ", right:"Á°¨„ÅÑ"}, {left:"„Åï„Å£„Å±„Çä", right:"„Åì„Å£„Å¶„Çä"}, {left:"‰∏ªÂΩπ", right:"ËÑáÂΩπ"}, {left:"È£≤„ÅøÁâ©„Å´Ëøë„ÅÑ", right:"È£ü„ÅπÁâ©„Å´Ëøë„ÅÑ"}, {left:"È¶ô„Çä„Åå„ÅÑ„ÅÑ", right:"Âë≥„ÅåÂº∑„ÅÑ"}, {left:"È´ò„ÅÑ„Åë„Å©Â∞ëÈáè", right:"ÂÆâ„ÅÑ„Åë„Å©Â§ßÈáè"}, {left:"ÂÜ¨„Å´È£ü„Åπ„Åü„ÅÑ", right:"Â§è„Å´È£ü„Åπ„Åü„ÅÑ"}, {left:"Â§™„Çã", right:"Áó©„Åõ„Çã"}, {left:"ÁÆ∏„ÅßÈ£ü„Åπ„Çã", right:"„Çπ„Éó„Éº„É≥„ÅßÈ£ü„Åπ„Çã"}, {left:"È´òÁ¥öÊñôÁêÜ", right:"BÁ¥ö„Ç∞„É´„É°"}
        ],
        human: [
            {left:"Èô∞„Ç≠„É£", right:"ÈôΩ„Ç≠„É£"}, {left:"‰ø°È†º„Åß„Åç„Çã", right:"ÊÄ™„Åó„ÅÑ"}, {left:"Áîò„Åà‰∏äÊâã", right:"„Åó„Å£„Åã„ÇäËÄÖ"}, {left:"ÂèãÈÅî„Å´„Å™„Çä„Åü„ÅÑ", right:"ÈÅ†„Åè„Åã„ÇâË¶ã„Å¶„Åü„ÅÑ"}, {left:"„É¢„ÉÜ„Åù„ÅÜ", right:"„É¢„ÉÜ„Å™„Åï„Åù„ÅÜ"}, {left:"ÂÜÖÂêëÁöÑ", right:"Â§ñÂêëÁöÑ"}, {left:"„Åä‰∫∫Â•Ω„Åó", right:"ÊÑèÂú∞ÊÇ™"}, {left:"„Ç§„É≥„Éâ„Ç¢", right:"„Ç¢„Ç¶„Éà„Éâ„Ç¢"}, {left:"Êµ™Ë≤ªÂÆ∂", right:"ÁØÄÁ¥ÑÂÆ∂"}, {left:"Ë´ñÁêÜÁöÑ", right:"ÊÑüÊÉÖÁöÑ"}, {left:"ÊúùÂûã", right:"Â§úÂûã"}, {left:"ËÅû„Åç‰∏äÊâã", right:"Ë©±„Åó‰∏äÊâã"}, {left:"Â§©ÁÑ∂", right:"„Åó„Å£„Åã„ÇäËÄÖ"}, {left:"Âπ≥Âíå‰∏ªÁæ©", right:"Â•ΩÊà¶ÁöÑ"}, {left:"„Çª„É≥„Çπ„Åå„ÅÇ„Çã", right:"Âä™Âäõ„ÅÆ‰∫∫"}, {left:"Â≠ê‰æõ„Å£„ÅΩ„ÅÑ", right:"Â§ß‰∫∫„Å≥„Å¶„ÅÑ„Çã"}, {left:"ÊÖéÈáç", right:"Â§ßËÉÜ"}, {left:"Âô®Áî®", right:"‰∏çÂô®Áî®"}, {left:"‰∏ÄÂåπÁãº", right:"ÂØÇ„Åó„Åå„Çä„ÇÑ"}, {left:"Ê•ΩË¶≥ÁöÑ", right:"ÊÇ≤Ë¶≥ÁöÑ"}, {left:"Âòò„Åå‰∏ãÊâã", right:"Âòò„Åå‰∏äÊâã"}, {left:"Ëá™‰ø°ÂÆ∂", right:"Ë¨ôËôö"}, {left:"ÈÉΩ‰ºöÊ¥æ", right:"Áî∞ËàéÊ¥æ"}, {left:"È†ëÂõ∫", right:"Á¥†Áõ¥"}, {left:"Â§©ÊâçËÇå", right:"ÁßÄÊâçËÇå"}, {left:"ÊØíËàå", right:"‰∏ÅÂØß"}, {left:"ÈÅä„Å≥‰∫∫", right:"ÁúüÈù¢ÁõÆ"}, {left:"„Éü„Çπ„ÉÜ„É™„Ç¢„Çπ", right:"ÂàÜ„Åã„Çä„ÇÑ„Åô„ÅÑ"}, {left:"ÊÄñ„Åù„ÅÜ", right:"ÂÑ™„Åó„Åù„ÅÜ"}
        ],
        life: [
            {left:"Âú∞Âë≥„Å™‰ªï‰∫ã", right:"Ê¥æÊâã„Å™‰ªï‰∫ã"}, {left:"ÈÅã", right:"Âä™Âäõ"}, {left:"Ë™∞„Åß„ÇÇ„Åß„Åç„Çã", right:"ËÅ∑‰∫∫Ëä∏"}, {left:"Â∞ÜÊù•„Å™„Åè„Å™„Çä„Åù„ÅÜ", right:"‰∏ÄÁîüÊÆã„Çä„Åù„ÅÜ"}, {left:"Ë∂£Âë≥", right:"‰ªï‰∫ã"}, {left:"„Ç¢„Éä„É≠„Ç∞", right:"„Éá„Ç∏„Çø„É´"}, {left:"ÈÉΩ‰ºö", right:"Áî∞Ëàé"}, {left:"Êò≠Âíå", right:"‰ª§Âíå"}, {left:"‰∏Ä‰∫∫ÊóÖ", right:"„Ç∞„É´„Éº„ÉóÊóÖË°å"}, {left:"ÊµÅË°å", right:"ÂÆöÁï™"}, {left:"ÂÆüÁî®ÁöÑ", right:"Ëä∏Ë°ìÁöÑ"}, {left:"Âπ≥Êó•„ÅÆÊòºÈñì", right:"‰ºëÊó•„ÅÆÂ§ú"}, {left:"ÂæíÊ≠©", right:"‰πó„ÇäÁâ©"}, {left:"Ëá™Áî±", right:"ÂÆâÂÆö"}, {left:"Ë≥™Á¥†", right:"Ë¥ÖÊ≤¢"}, {left:"Èù¢ÂÄí„Åè„Åï„ÅÑ", right:"Ê•Ω„Åó„ÅÑ"}, {left:"ÂäπÁéáÈáçË¶ñ", right:"ÊÉÖÁ∑íÈáçË¶ñ"}, {left:"Ëá™ÂàÜÁî®", right:"„Éó„É¨„Çº„É≥„ÉàÁî®"}, {left:"‰∏ÄÁõÆÊÉö„Çå", right:"Âæê„ÄÖ„Å´Â•Ω„Åç„Å´„Å™„Çã"}, {left:"ÂÆ∂‰∫ã", right:"ËÇ≤ÂÖê"}, {left:"Ë≤ØÈáë", right:"ÊäïË≥á"}, {left:"ÂâØÊ•≠", right:"Êú¨Ê•≠"}, {left:"„Çπ„Ç≠„É´", right:"‰∫∫ËÑà"}, {left:"Áù°Áú†", right:"Ê¥ªÂãï"}, {left:"ÊéÉÈô§", right:"ÊñôÁêÜ"}
        ],
        nuance: [
            {left:"„Ç¥„Éü", right:"ÂÆùÁâ©"}, {left:"„ÉÄ„Çµ„Åã„Å£„Åì„ÅÑ„ÅÑ", right:"„Ç¨„ÉÅ„Åß„Åã„Å£„Åì„ÅÑ„ÅÑ"}, {left:"Áå´„Å£„ÅΩ„ÅÑ", right:"Áä¨„Å£„ÅΩ„ÅÑ"}, {left:"ÊÄñ„ÅÑ", right:"Èù¢ÁôΩ„ÅÑ"}, {left:"„Ç´„Ç∏„É•„Ç¢„É´", right:"„Éï„Ç©„Éº„Éû„É´"}, {left:"„Éû„Éã„Ç¢„ÉÉ„ÇØ", right:"„É°„Ç∏„É£„Éº"}, {left:"„Çª„ÇØ„Ç∑„Éº", right:"„Ç≠„É•„Éº„Éà"}, {left:"„Ç®„É¢„ÅÑ", right:"ÁêÜË´ñÁöÑ"}, {left:"ÊîªÊíÉÁöÑ", right:"ÂÆàÂÇôÁöÑ"}, {left:"Áî∑„Çâ„Åó„ÅÑ", right:"Â•≥„Çâ„Åó„ÅÑ"}, {left:"Á•ûÁßòÁöÑ", right:"ÁßëÂ≠¶ÁöÑ"}, {left:"‰∏äÂìÅ", right:"‰∏ãÂìÅ"}, {left:"Ê¥æÁîü‰ΩúÂìÅ", right:"„Ç™„É™„Ç∏„Éä„É´"}, {left:"ËÑáÂΩπ", right:"‰∏ª‰∫∫ÂÖ¨"}, {left:"Â∞ëÂπ¥Êº´Áîª", right:"ÈùíÂπ¥Êº´Áîª"}, {left:"ÁéãÈÅì", right:"ÈÇ™ÈÅì"}, {left:"Êáê„Åã„Åó„ÅÑ", right:"Êñ¨Êñ∞"}, {left:"„Éè„Éº„Éâ„Éú„Ç§„É´„Éâ", right:"„É°„É´„Éò„É≥"}, {left:"Áü•ÁöÑ", right:"ËÇâ‰ΩìÁöÑ"}, {left:"Áõ¥ÊÑüÁöÑ", right:"Ë®àÁÆóÁöÑ"}, {left:"ÂÖâ", right:"ÂΩ±"}, {left:"„Éâ„É©„Éû„ÉÅ„ÉÉ„ÇØ", right:"Ê∑°„ÄÖ„Å®„Åó„Å¶„ÅÑ„Çã"}, {left:"Â•áË∑°", right:"ÂøÖÁÑ∂"}, {left:"‰∏ªË¶≥ÁöÑ", right:"ÂÆ¢Ë¶≥ÁöÑ"}
        ],
        mixed: [
            {left:"„ÅÇ„Å§„ÅÑ", right:"„Å§„ÇÅ„Åü„ÅÑ"}, {left:"Á°¨„ÅÑ", right:"Êüî„Çâ„Åã„ÅÑ"}, {left:"‰∏∏„ÅÑ", right:"Â∞ñ„Å£„Åü"}, {left:"ËªΩ„ÅÑ‰∏≠ÊØíÊÄß", right:"È´ò„ÅÑ‰∏≠ÊØíÊÄß"}, {left:"ÁÑ°Ëâ≤", right:"„Ç´„É©„Éï„É´"}, {left:"È¢®Âë≥„Åå„Å™„ÅÑ", right:"È¢®Âë≥Ë±ä„Åã"}, {left:"Âç±Èô∫„Å™‰ªï‰∫ã", right:"ÂÆâÂÖ®„Å™‰ªï‰∫ã"}, {left:"Â£ä„Çå„ÇÑ„Åô„ÅÑ", right:"Â£ä„Çå„Å´„Åè„ÅÑ"}, {left:"‰∏çÁ¥∞Â∑•", right:"„Ç§„Ç±„É°„É≥"}, {left:"ÊØõ„Åå„Å™„ÅÑ", right:"ÊØõÊ∑±„ÅÑ"}, {left:"ÊüîËªüÊÄß„Åå„Å™„ÅÑ", right:"ÊüîËªüÊÄß„Åå„ÅÇ„Çã"}, {left:"ÊôÆÈÄö„ÅÆ„Éö„ÉÉ„Éà", right:"Â§â„Çè„Å£„Åü„Éö„ÉÉ„Éà"}, {left:"ÂΩ±„ÅåËñÑ„ÅÑ", right:"Â≠òÂú®ÊÑü„Åå„ÅÇ„Çã"}, {left:"„Éê„Ç§„Éà", right:"ËÅ∑Ê•≠"}, {left:"Â´å„Çè„Çå„Å¶„ÅÑ„Çã", right:"ÊÑõ„Åï„Çå„Å¶„ÅÑ„Çã"}, {left:"Áõ¥Á∑ö", right:"Êõ≤Á∑ö"}, {left:"Ê≠¥Âè≤ÁöÑ„Å´ÈáçË¶Å„Åß„Å™„ÅÑ", right:"Ê≠¥Âè≤ÁöÑ„Å´ÈáçË¶Å"}, {left:"Á∂¥„Çä„ÅåÁ∞°Âçò", right:"Á∂¥„Çä„ÅåÈõ£„Åó„ÅÑ"}, {left:"‰∏çÂÆâÂÆö", right:"ÂÆâÂÆö"}, {left:"Â•≥„Å£„ÅΩ„ÅÑ", right:"Áî∑„Çâ„Åó„ÅÑ"}, {left:"ÂΩπ„Å´Á´ã„Åü„Å™„ÅÑ‰Ωì„ÅÆÈÉ®‰Ωç", right:"ÂΩπ„Å´Á´ã„Å§‰Ωì„ÅÆÈÉ®‰Ωç"}, {left:"„É¥„Ç£„É©„É≥", right:"„Éí„Éº„É≠„Éº"}, {left:"Â≠ê‰æõÂêë„Åë", right:"Â§ß‰∫∫Âêë„Åë"}, {left:"ÊúâÈôê", right:"ÁÑ°Èôê"}, {left:"ÁßòÂØÜ", right:"Ë™∞„ÇÇ„ÅåÁü•„Å£„Å¶„ÅÑ„Çã"}, {left:"Â∞è„Åï„Åô„Åé„Çã", right:"Â§ß„Åç„Åô„Åé„Çã"}, {left:"Áü≠„ÅÑ", right:"Èï∑„ÅÑ"}, {left:"Â∞ëÊï∞", right:"Â§öÊï∞"}, {left:"Ë™§", right:"Ê≠£"}, {left:"‰∏çËá™ÁÑ∂", right:"Ëá™ÁÑ∂"}, {left:"ÂôÇ", right:"„Éã„É•„Éº„Çπ"}, {left:"Ê∞¥Âπ≥", right:"ÂûÇÁõ¥"}, {left:"„Éì„Ç∏„Éç„Çπ", right:"„Ç¢„Éº„Éà"}, {left:"‰∏ÄÁô∫Â±ã", right:"„Çπ„Çø„Éº"}, {left:"ÊÇ™„ÅÑ„Ç¢„Éâ„Éê„Ç§„Çπ", right:"ËâØ„ÅÑ„Ç¢„Éâ„Éê„Ç§„Çπ"}, {left:"‰ºùÁµ±ÁöÑ", right:"Èù©Êñ∞ÁöÑ"}, {left:"ÈÅïÊ≥ï", right:"ÂêàÊ≥ï"}, {left:"ÊµÖ„ÅÑËÄÉ„Åà", right:"Ê∑±„ÅÑËÄÉ„Åà"}, {left:"ÊôÇÈñì„ÇíÂÆà„Çâ„Å™„ÅÑ", right:"ÊôÇÈñì„ÇíÂÆà„Çã"}, {left:"ÂêçÈ´ò„ÅÑ", right:"ÊÇ™ÂêçÈ´ò„ÅÑ"}, {left:"ÊÉ≥ÂÆöÂÜÖ", right:"ÊÉ≥ÂÆöÂ§ñ"}, {left:"„Åµ„Çè„Åµ„Çè", right:"„Åß„Åì„Åº„Åì"}, {left:"„Åä„Å´„Åé„Çä„ÅÆÂÖ∑„Å´‰∏çÂêë„Åç", right:"„Åä„Å´„Åé„Çä„ÅÆÂÖ∑„Å´Âêë„ÅÑ„Å¶„ÅÑ„Çã"}, {left:"‰∏ãÊâã", right:"‰∏äÊâã"}, {left:"Âè§„ÅÑ", right:"Êñ∞„Åó„ÅÑ"}, {left:"„ÉÄ„Çµ„ÅÑ", right:"„Åä„Åó„ÇÉ„Çå"}, {left:"Ê¥óÁ∑¥„Åï„Çå„Åü", right:"ÈáéÊöÆ„Å£„Åü„ÅÑ"}, {left:"ÈÄÄÂ±à", right:"„Ç®„Ç≠„Çµ„Ç§„ÉÜ„Ç£„É≥„Ç∞"}, {left:"ÂÆóÊïôÁöÑ", right:"‰∏ñ‰øóÁöÑ"}, {left:"Áµ∂ÊªÖ„Åó„Åù„ÅÜ", right:"Â¢ó„Åà„Åô„Åé„Å¶„ÅÑ„Çã"}, {left:"ÁÑ°ÂÆ≥", right:"ÊúâÂÆ≥"}, {left:"‰ΩéË≥ÉÈáë", right:"È´òË≥ÉÈáë"}, {left:"Á¶Å„Åò„Çâ„Çå„Åü", right:"Êé®Â•®„Åï„Çå„Åü"}, {left:"ÊÇ≤„Åó„ÅÑ", right:"Âπ∏„Åõ"}, {left:"‰∏çÂÅ•Â∫∑", right:"ÂÅ•Â∫∑"}, {left:"Êö¥ÂäõÁöÑ„Å™", right:"Âπ≥ÂíåÁöÑ„Å™"}, {left:"ËÑÜ„ÅÑ", right:"È†ë‰∏à„Å™"}, {left:"„Å§„Åæ„Çâ„Å™„ÅÑ", right:"È≠ÖÂäõÁöÑ"}, {left:"Ê±ö„ÅÑË®ÄËëâ", right:"Áæé„Åó„ÅÑË®ÄËëâ"}, {left:"„Éû„Éã„Ç¢Âêë„Åë", right:"Â§ßË°ÜÂêë„Åë"}, {left:"Áã¨ÂâµÁöÑ", right:"Ê®°ÂÄ£ÁöÑ"}, {left:"Â≠§Áã¨", right:"Á§æ‰∫§"}, {left:"ÈÅéÂéª„ÅÆÊ†ÑÂÖâ", right:"Â∞ÜÊù•ÊÄß"}, {left:"‰æùÂ≠ò", right:"Ëá™Á´ã"}, {left:"Ë§áÈõë", right:"ÂçòÁ¥î"}, {left:"‰∏çË¶™Âàá", right:"Ë¶™Âàá"}, {left:"Ê∂àÊ•µÁöÑ", right:"Á©çÊ•µÁöÑ"}, {left:"Â§¢„Åå„ÅÇ„Çã", right:"ÁèæÂÆüÁöÑ"}, {left:"‰∏çË¶èÂâá", right:"Ë¶èÂâáÁöÑ"}, {left:"Â≠ê‰æõ„ÅÆÈÅä„Å≥", right:"Â§ß‰∫∫„ÅÆË∂£Âë≥"}, {left:"ÂéüÂßãÁöÑ", right:"ÂÖàÈÄ≤ÁöÑ"}, {left:"Áü≠ÂëΩ", right:"Èï∑Áîü„Åç"}, {left:"„Éã„ÉÉ„ÉÅ", right:"„É°„Ç∏„É£„Éº"}, {left:"Áµ∂Êúõ", right:"Â∏åÊúõ"}
        ]
    };

    // „Åô„Åπ„Å¶„ÅÆ„ÅäÈ°å„ÇíÁµêÂêà
    const allTopics = [].concat(...Object.values(topicStore));

    const gameState = {
        currentTeam: 'red', redScore: 0, blueScore: 0,
        topic: null, targetAngle: 0, guessAngle: 0, vote: null,
        changeCount: 0, maxChanges: 3
    };

    function updateTeamDisplay() {
        const isRed = gameState.currentTeam === 'red';
        document.body.className = isRed ? 'red-team-turn' : 'blue-team-turn';
        document.getElementById('redTeamScore').textContent = `Ëµ§: ${gameState.redScore}`;
        document.getElementById('blueTeamScore').textContent = `Èùí: ${gameState.blueScore}`;
        document.getElementById('redTeamScore').classList.toggle('current-team', isRed);
        document.getElementById('blueTeamScore').classList.toggle('current-team', !isRed);
        
        const teamName = isRed ? 'Ëµ§„ÉÅ„Éº„É†' : 'Èùí„ÉÅ„Éº„É†';
        const oppName = isRed ? 'Èùí„ÉÅ„Éº„É†' : 'Ëµ§„ÉÅ„Éº„É†';
        document.getElementById('currentTeamIndicator').textContent = teamName;
        document.getElementById('psychicTeamIndicator').textContent = teamName;
        document.getElementById('voteTeamIndicator').textContent = oppName;
        document.getElementById('guessTeamIndicator').textContent = teamName;
    }

    function startNewGame() {
        gameState.redScore = 0; gameState.blueScore = 0;
        gameState.currentTeam = 'red';
        updateTeamDisplay();
        showPhase('phase-round-start');
    }

    function showPhase(id) {
        document.querySelectorAll('.game-phase').forEach(p => p.classList.add('hidden'));
        document.getElementById(id).classList.remove('hidden');
    }

    function startRound() {
        pickTopic();
        gameState.targetAngle = (Math.random() * 144) - 72;
        gameState.changeCount = 0;
        updateChangeBtn();
        drawDial(document.getElementById('psychic-svg'), gameState.targetAngle);
        showPhase('phase-psychic');
    }

    function pickTopic() {
        gameState.topic = allTopics[Math.floor(Math.random() * allTopics.length)];
        document.getElementById('topicText').innerHTML = `<span>${gameState.topic.left}</span><span>‚áî</span><span>${gameState.topic.right}</span>`;
        document.getElementById('leftLabel').textContent = gameState.topic.left + 'ÂØÑ„Çä';
        document.getElementById('rightLabel').textContent = gameState.topic.right + 'ÂØÑ„Çä';
    }

    function changeTopic() {
        if (gameState.changeCount < gameState.maxChanges) {
            pickTopic();
            gameState.targetAngle = (Math.random() * 144) - 72;
            gameState.changeCount++;
            updateChangeBtn();
            drawDial(document.getElementById('psychic-svg'), gameState.targetAngle);
        }
    }

    function updateChangeBtn() {
        const b = document.getElementById('changeTopicBtn');
        b.textContent = `„ÅäÈ°åÂ§âÊõ¥ (${gameState.changeCount}/${gameState.maxChanges})`;
        b.disabled = gameState.changeCount >= gameState.maxChanges;
    }

    function goToVotePhase() { showPhase('phase-vote'); }

    function submitVote(side) {
        gameState.vote = side;
        gameState.guessAngle = 0;
        updateNeedle(document.getElementById('needle'), 0);
        positionKnob(0);
        drawDial(document.getElementById('guess-svg'), null);
        showPhase('phase-guess');
    }

    function submitGuess() {
        const diff = Math.abs(gameState.guessAngle - gameState.targetAngle);
        let pts = 0;
        if (diff <= 4) pts = 4;
        else if (diff <= 10) pts = 3;
        else if (diff <= 16) pts = 2;

        const targetSide = gameState.targetAngle < 0 ? 'left' : 'right';
        let votePts = (gameState.vote === targetSide) ? 1 : 0;

        if (gameState.currentTeam === 'red') {
            gameState.redScore += pts; gameState.blueScore += votePts;
        } else {
            gameState.blueScore += pts; gameState.redScore += votePts;
        }

        document.getElementById('resultSummary').innerHTML = `
            <div style="font-size:1.5rem;font-weight:700">${pts}ÁÇπ Áç≤ÂæóÔºÅ</div>
            <p>Áõ∏Êâã„ÅÆÊäïÁ•®„ÅØ... ${votePts?'Ê≠£Ëß£ÔºÅ(+1ÁÇπ)':'‰∏çÊ≠£Ëß£'}</p>
        `;
        drawDial(document.getElementById('result-svg'), gameState.targetAngle);
        updateNeedle(document.getElementById('result-needle'), gameState.guessAngle);
        showPhase('phase-result');

        if (gameState.redScore >= 11 || gameState.blueScore >= 11) {
            document.getElementById('nextRoundBtn').textContent = "ÊúÄÁµÇÁµêÊûú„Å∏";
            document.getElementById('nextRoundBtn').onclick = () => {
                const winner = gameState.redScore > gameState.blueScore ? 'Ëµ§„ÉÅ„Éº„É†' : 'Èùí„ÉÅ„Éº„É†';
                document.getElementById('winnerAnnouncement').textContent = `üéâ ${winner}„ÅÆÂãùÂà©ÔºÅ üéâ`;
                showPhase('phase-game-over');
            };
        }
    }

    function nextRound() {
        gameState.currentTeam = gameState.currentTeam === 'red' ? 'blue' : 'red';
        updateTeamDisplay();
        showPhase('phase-round-start');
    }

    function drawDial(svg, target) {
        svg.innerHTML = '';
        const cx=160, cy=160, r=160;
        if (target !== null) {
            const zones = [{w:32, c:'#FFC107'}, {w:20, c:'#FF9800'}, {w:8, c:'#03A9F4'}];
            zones.forEach(z => {
                const s = (target - z.w/2 - 90) * Math.PI / 180;
                const e = (target + z.w/2 - 90) * Math.PI / 180;
                const x1 = cx + r * Math.cos(s), y1 = cy + r * Math.sin(s);
                const x2 = cx + r * Math.cos(e), y2 = cy + r * Math.sin(e);
                const p = document.createElementNS('http://www.w3.org/2000/svg','path');
                p.setAttribute('d', `M ${cx} ${cy} L ${x1} ${y1} A ${r} ${r} 0 0 1 ${x2} ${y2} Z`);
                p.setAttribute('fill', z.c);
                svg.appendChild(p);
            });
        }
        const border = document.createElementNS('http://www.w3.org/2000/svg','path');
        border.setAttribute('d', `M 0 160 A 160 160 0 0 1 320 160`);
        border.setAttribute('stroke', '#3D4A5E');
        border.setAttribute('stroke-width', '8');
        border.setAttribute('fill', 'none');
        svg.appendChild(border);
    }

    function updateNeedle(el, a) { el.style.transform = `translateX(-50%) rotate(${a}deg)`; }
    function positionKnob(a) {
        const rad = (a - 90) * Math.PI / 180;
        const x = 160 + 160 * Math.cos(rad), y = 160 + 160 * Math.sin(rad);
        const k = document.getElementById('knob');
        k.style.left = `${(x/320)*100}%`; k.style.top = `${(y/160)*100}%`;
    }

    let isDrag = false;
    const dial = document.getElementById('guess-dial');
    function move(e) {
        if (!isDrag) return;
        const rect = dial.getBoundingClientRect();
        const cx = e.touches ? e.touches[0].clientX : e.clientX;
        const cy = e.touches ? e.touches[0].clientY : e.clientY;
        const dx = cx - (rect.left + rect.width/2);
        const dy = (rect.top + rect.height) - cy;
        let a = Math.atan2(dx, dy) * 180 / Math.PI;
        a = Math.max(-90, Math.min(90, a));
        gameState.guessAngle = a;
        updateNeedle(document.getElementById('needle'), a);
        positionKnob(a);
        document.getElementById('gaugeValue').textContent = Math.round(((a+90)/180)*100);
    }
    document.getElementById('knob').onmousedown = () => isDrag = true;
    document.getElementById('knob').ontouchstart = (e) => { isDrag = true; e.preventDefault(); };
    window.onmousemove = move; window.ontouchmove = move;
    window.onmouseup = () => isDrag = false; window.ontouchend = () => isDrag = false;
    </script>
</body>
</html>
